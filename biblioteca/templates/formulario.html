{% load static %}
<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Abastible Jano Gas</title>
    <link rel="icon" type="image/x-icon" href="{% static 'img/AbastibleIcono1.png' %}">
    <link rel="stylesheet" href="{% static 'css/misEstilos.css' %}">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
  <!--BARRA DE NAVEGACION-->
        <nav class="navbar navbar-expand-sm navbar-light bg-light, menu">
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" 
                data-bs-target="#opciones" style="margin-left: 15px;">
                <span class="navbar-toggler-icon"></span>
            </button>
            
              <a href="{% url 'inicio' %}"class="navbar-brand">
                <img src="{% static 'img/AbastibleIcono2.png' %}" width="30px" height="30px" style="margin-left: 15px;">
              </a>
              <div class="collapse navbar-collapse" id="opciones">
                <div>
                  {% if user.is_authenticated %}
                          <a href="#" style="color:blueviolet; font-size: 12px; justify-content: right;">Bienvenid@ {{user.username}}</a>
                          <a href="{% url 'cerrar' %}" id="userBookStop">
                              <img src="{% static 'img/user-vector-icon.png' %}" alt="NO DATA FOUND" width="20px">Cerrar sesión
                          </a>
                  {% else %}
                      <a href="{% url 'login' %}" id="userBookSto" style="color:blueviolet; text-align:  right;">
                          <img src="{% static 'img/user-vector-icon.png' %}" alt="NO DATA FOUND" width="20px">Iniciar sesión
                      </a>
                  {% endif %}
              </div>
              <!-- Links -->
              <div class="collapse navbar-collapse" id="opciones">
                <ul class="navbar-nav" style="margin-left: 15px;">
                  <li class="nav-item">
                    <a class="nav-link" href="{% url 'inicio' %}">Inicio</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="{% url 'tienda' %}">Tienda</a>
                  </li>
                  {% if user.is_authenticated %}
                    <li class="nav-item">
                        <a class="nav-link" href="{% url 'productos' %}">Productos</a>
                    </li>
                {% endif %}
                  <li class="nav-item">
                    <a class="nav-link" href="{% url 'quienesSomos' %}">Quienes Somos</a>
                  </li>
                  
                  <li class="nav-item">
                    <a class="nav-link" href="{% url 'trabajaConNosotros' %}">Trabaja Con Nosotros</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="{% url 'reservaTuGas'%}">Reserva Tu Gas</a>
                  <li class="nav-item">
                    <a class="nav-link" href="{% url 'cotizarPrecio' %}">Encuentra Tu Gas</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="{% url 'disponibilidad' %}">Disponibilidad</a>
                  </li>
                </ul>
              </div>
          </nav>
  
    <div class="container">
      <h2 style="color:rgb(255, 255, 255); font-family: Arial, Helvetica, sans-serif Impact, Haettenschweiler, 'Arial Narrow Bold', sans-serif;">Reserva de Gas Abastible</h2>
      <div class="row">
        <form id="pedidoForm">

          <div>  
            <label for="cantidad" Class="etiqueta">Cantidad del producto:</label>
            <input type="number" id="cantidad" min="1" required class="form-control">
            <span class="error" id="errorCantidad"></span>
          </div>

          <div>
            <label for="variante" Class="etiqueta">Tamaño o variedad del producto:</label>
            <select id="variante" class="form-control" required>
              <option value="pequeño">Pequeño</option>
              <option value="mediano">Mediano</option>
              <option value="grande">Grande</option>
              <option value="supergrande">Supergrande</option>
            </select>
            <span class="error" id="errorVariante"></span>
          </div>
          
          <div>
            <label Class="etiqueta">Método de envío:</label><br>
            <input type="radio" id="retiroEnLocal" name="envio" value="Retiro en local" checked>
            <label for="retiroEnLocal">Retiro en local</label><br>
            <input type="radio" id="delivery" name="envio" value="Delivery">
            <label for="delivery">Delivery</label>
          </div>

          <div>
            <label for="celu" class="etiqueta">Número Celular(*): </label>
            <input type="text" class="form-control alto" id="celu" name="celu" minlength="3" maxlength="9" placeholder="Escriba algún número CELULAR..." required>
            <span class="error" id="errorCelu"></span>
          </div>

          <div>
            <label for="direccion" Class="etiqueta">Dirección de entrega:</label>
            <input type="text" id="direccion" required class="form-control">
            <span class="error" id="errorDireccion"></span>
          </div>

          <div>
            <label Class="etiqueta">Total a pagar: </label>
            <span class="form-control" id="total">$</span>
          </div>
          <br>
          <button type="button" id="reservarPedido" class="btn btn-primary">Reservar pedido</button>
        </form>
      </div>
    </div>
      
    <footer class="footer bg-dark text-light text-center py-3 fixed-bottom">
      <div class="container">
          <span> &copy; Jano Gas - Todos los derechos reservados 2024</span>
          <a href="https://www.facebook.com/jano.gas.1/?locale=es_LA" class="RedesSociales">
            <img src="{% static 'img/feibukk.webp' %}" width="47px" height="47px" style="margin-left: 15px;">
          </a>
          <a href="https://www.instagram.com/jano_gas?igsh=MWUxNHcxMTV5c2h1ZQ%3D%3D" class="RedesSociales">
            <img src="{% static 'img/instagraaaam.png' %}" width="31px" height="31px" style="margin-left: 15px;">
          </a>
          <a href="index.html" class="RedesSociales">
            <img src="{% static 'img/AbastibleIcono1.png' %}" width="30px" height="30px" style="margin-left: 15px;">
          </a>
      </div>
    </footer>

    <script>

document.getElementById("cantidad").addEventListener("keypress", function(event) {
    const key = String.fromCharCode(event.keyCode);
    if (!/^\d+$/.test(key)) {
        event.preventDefault();
    }
});

document.getElementById("reservarPedido").addEventListener("click", function() {
    let valid = true;
    const cantidad = document.getElementById("cantidad");
    const variante = document.getElementById("variante");
    const celu = document.getElementById("celu");
    const direccion = document.getElementById("direccion");


    document.getElementById("errorCantidad").innerText = "";
    document.getElementById("errorVariante").innerText = "";
    document.getElementById("errorCelu").innerText = "";
    document.getElementById("errorDireccion").innerText = "";

 
    if (cantidad.value === "" || cantidad.value <= 0) {
        document.getElementById("errorCantidad").innerText = "Por favor ingrese una cantidad válida (mayor que 0).";
        valid = false;
    }

    if (variante.value === "") {
        document.getElementById("errorVariante").innerText = "Por favor seleccione una variedad.";
        valid = false;
    }


    const celuPattern = /^[0-9]{9}$/;
    if (!celuPattern.test(celu.value)) {
        document.getElementById("errorCelu").innerText = "Por favor ingrese un número de celular válido (9 dígitos).";
        valid = false;
    }


    if (direccion.value.trim() === "") {
        document.getElementById("errorDireccion").innerText = "Por favor ingrese una dirección.";
        valid = false;
    }

    if (valid) {
        alert("Pedido reservado con éxito!");
    }
});

      document.getElementById('pedidoForm').addEventListener('input', calcularTotal);

      document.getElementById('reservarPedido').addEventListener('click', function() {
          if (validarDatos()) {
              alert('Se ha reservado exitosamente');
          } else {
              alert('Por favor rellene todos los datos');
          }
      });
      
      function calcularTotal() {
        var cantidad = parseInt(document.getElementById('cantidad').value);
        var variante = document.getElementById('variante').value;
        var envio = document.querySelector('input[name="envio"]:checked').value;
      
        
        var costoBase = 0;
        switch (variante) {
          case 'pequeño':
            costoBase = 17000;
            break;
          case 'mediano':
            costoBase = 20500;
            break;
          case 'grande':
            costoBase = 29500;
            break;
          case 'supergrande':
            costoBase = 84000;
            break;
        }
        
        var costoEnvio = 0;
        if (envio === 'Retiro en local') {
          costoEnvio = -2000; 
        } else if (envio === 'Delivery') { 
          costoEnvio = 0; 
        }
      
        
        var total = cantidad * (costoBase + costoEnvio);
      

        document.getElementById('total').textContent = '$' + total.toFixed(0);
      }

      function validarDatos() {
          let cantidad = document.getElementById('cantidad').value;
          let direccion = document.getElementById('direccion').value;
          let celu = document.getElementById('celu').value

          if (cantidad === '' || direccion === '' || celu === '') {
              return false;
          }
          return true;
      }
    </script>

<script src="{% static 'js/funciones.js' %}"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>